<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1">

<meta name="author" content="Matthew Carli, Salem Rustom, David Wheeler" />

<meta name="date" content="2020-06-27" />

<title>groupWQS Vignette</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>



<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#header {
text-align: center;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; }  code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore"><code>groupWQS</code> Vignette</h1>
<h4 class="author">Matthew Carli, Salem Rustom, David Wheeler</h4>
<h4 class="date">2020-06-27</h4>



<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" title="1"><span class="kw">library</span>(groupWQS)</a></code></pre></div>
<div id="introduction" class="section level1">
<h1>Introduction</h1>
<p>Weighted Quantile Sum (WQS) regression (Carrico et al., 2015) was developed to assess the effect of chemical mixtures (usually from the environment) on the risk of an adverse event such as cancer. The method allows one to identify “bad actor” chemicals through non-zero weights where the data are highly correlated and high dimensional (typical in chemical concentration data). Studies have shown it to be more accurate in identifying these chemicals (via sensitivity and specificity) than traditional regression and regularization methods such as LASSO, adaptive LASSO, and elastic net (Czarnota et al., 2015 Cancer Informatics). WQS regression treats all chemicals as being part of one group and having the same direction of association with the outcome. Grouped Weighted Quantile Sum (GWQS) regression (Czarnota and Wheeler, 2016) extends this method to allow one to place chemicals into groups such that different magnitudes and direction of associations can be determined for each pre-defined group of chemicals. For example, some types of chemicals may have a harmful effect (i.e. increase risk of cancer) while others may have a protective effect.</p>
<p>Specifically, GWQS uses data with <em>i=1,…,C</em> components split between <em>j=1,…,K</em> groups. Within each of these <em>K</em> groups, the components are scored into quantiles that can be plausibly combined into an index. The weights <span class="math inline">\(w_i\)</span> are constrained to be between 0 and 1 and sum to 1, which in turn addresses potential issues with collinearity and high dimensionality. The general form of GWQS regression can be expressed as:</p>
<p><span class="math display">\[
\begin{equation}
\tag{1}
g(\mu)=\beta_{0}+\sum_{j=1}^{K}\left[\beta_{j}\left(\sum_{i=1}^{c_{j}} w_{j i} q_{j i}\right)\right]+z^{T} \phi 
\end{equation}
\]</span></p>
<p>where <span class="math inline">\(w_{ji}\)</span> represents the weight for the <em>ith</em> chemical component <span class="math inline">\(q_{ji}\)</span>, and the summation <span class="math inline">\(\sum^{c_i}_{i=1}w_{ji}q_{ji}\)</span> represents a weighted index for the set of <span class="math inline">\(c_j\)</span> chemicals of interest within group <em>j</em>. The vector <em>z</em> is a vector of covariates for which to adjust. On the right hand side, <em>g</em> is a monotonic and differentiable link function that relates to the mean <span class="math inline">\(\mu\)</span>. The link function used depends on the type of outcome (e.g. continuous or binary). For inference, the equation (1) is run for <em>B</em> bootstraps where in each bootstrap sample the significance of the estimated vector of weights is evaluated through the significance (P≤0.05) of <span class="math inline">\(\hat{\beta}_j\)</span>, the parameter estimate of weighted index <em>j</em>. The estimated index for each of the <em>j</em> chemical groups is obtained by <span class="math inline">\(GWQS_j = \sum^{c_i}_{i=1}\bar{w_{ji}}q_{ji}\)</span> where <span class="math inline">\(\bar{w_{ji}}\)</span> is the weighted average of the <span class="math inline">\(\hat{\beta}_j\)</span> test statistics for component <em>i</em>. Significance of the group effects is assessed using the following model with the test dataset:</p>
<p><span class="math display">\[
\tag{2}
g(\mu)=\beta_{0}+\sum_{j=1}^{K}\left[GWQS_j\right]+z^{T} \phi 
\]</span></p>
<p>Nonlinear optimization of (1) using the <code>solnp</code> function from R is used to estimate the unknown weights and beta parameters. This function uses an augmented Lagrange multiplier method with a sequential quadratic programming interior algorithm.</p>
<p>The main function of <code>groupWQS</code> is <code>gwqs.fit</code>, which implements GWQS regression. The functions <code>make.X</code> and <code>make.x.s</code> are used to prepare data for regression, where <code>make.X</code> organizes user data into a matrix of desired groups while <code>make.x.s</code> forms a vector detailing the order and size of each group in the exposure matrix. The output of these two functions are used as arguments in the main <code>gwqs.fit</code> function. The model fit object that is returned can be fed into the <code>plot.weights</code> function, which visualizes the weight estimated for individual chemicals in each of the regressed groups. We provide an example analysis below to illustrate the usage of <code>groupWQS</code>.</p>
</div>
<div id="using-groupwqs" class="section level1">
<h1>Using <code>groupWQS</code></h1>
<div id="data-preparation" class="section level3">
<h3>Data Preparation</h3>
<p>The package <code>groupWQS</code> requires a dataframe where component variables used to construct indices are named. As an example, we will look at <code>simdata</code>:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" title="1"><span class="kw">data</span>(simdata)</a>
<a class="sourceLine" id="cb2-2" title="2"><span class="kw">head</span>(simdata)</a>
<a class="sourceLine" id="cb2-3" title="3"><span class="co">#&gt;    pcb_118  pcb_138  pcb_153   pcb_180   pcb_192        as        cu         pb</span></a>
<a class="sourceLine" id="cb2-4" title="4"><span class="co">#&gt; 1 2.360824 2.700214 3.536807 1.3630520  3.568884  4.332258 3.4998226  7.6088824</span></a>
<a class="sourceLine" id="cb2-5" title="5"><span class="co">#&gt; 2 2.788382 1.353622 2.328022 3.3261689 -2.020155 -1.146443 0.8174605 -1.6830696</span></a>
<a class="sourceLine" id="cb2-6" title="6"><span class="co">#&gt; 3 6.246413 3.166612 6.851131 7.2149506 10.504976  5.042383 6.2631718  7.2252882</span></a>
<a class="sourceLine" id="cb2-7" title="7"><span class="co">#&gt; 4 3.642265 2.881070 3.760282 4.3231974  3.368709  2.814906 3.9192663  2.1143266</span></a>
<a class="sourceLine" id="cb2-8" title="8"><span class="co">#&gt; 5 3.481870 3.820329 3.178467 0.9451579  3.786788  6.331203 2.2228106  4.8262313</span></a>
<a class="sourceLine" id="cb2-9" title="9"><span class="co">#&gt; 6 4.088892 4.799032 5.467218 4.2547060  6.078460  2.622098 1.8577607  0.6898549</span></a>
<a class="sourceLine" id="cb2-10" title="10"><span class="co">#&gt;         sn   carbaryl propoxur methoxychlor   diazinon chlorpyrifos Y</span></a>
<a class="sourceLine" id="cb2-11" title="11"><span class="co">#&gt; 1 3.975121  4.7416076 4.203351     4.598234  5.5571762    5.4269398 0</span></a>
<a class="sourceLine" id="cb2-12" title="12"><span class="co">#&gt; 2 1.710898 -0.4558587 2.255870     2.751266  2.6322118   -0.6704027 0</span></a>
<a class="sourceLine" id="cb2-13" title="13"><span class="co">#&gt; 3 4.857086  7.2872371 5.274585     6.739046 12.0197435    8.1984625 0</span></a>
<a class="sourceLine" id="cb2-14" title="14"><span class="co">#&gt; 4 3.798077  0.7455287 3.111616     2.940376  0.6781079    1.5744175 0</span></a>
<a class="sourceLine" id="cb2-15" title="15"><span class="co">#&gt; 5 4.409647  0.6547444 2.309184     3.652926  0.6819997    1.7293713 1</span></a>
<a class="sourceLine" id="cb2-16" title="16"><span class="co">#&gt; 6 4.374542  4.3322814 4.672852     4.023438  6.7486293    5.9936270 1</span></a></code></pre></div>
<p>These data represent chemical concentrations for 14 suspected carcinogens found in the environment, and the <code>Y</code> variable represents our case-control outcomes, 1 for cancer and 0 for cancer-free.</p>
<p>To prepare our data and let <code>gwqs.fit</code> know how many groups we want in our model, as well as which variables belong to which group, we use two functions:</p>
<ol style="list-style-type: decimal">
<li><code>make.X</code></li>
</ol>
<p><code>make.X</code> organizes component variables into a matrix suitable for analysis. To specify variable groups, we make a list of string vectors, each vector corresponding to a group and each string corresponding to a variable name. This list is then used as an argument in <code>make.X</code>.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" title="1">group_list &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="kw">c</span>(<span class="st">&quot;pcb_118&quot;</span>, <span class="st">&quot;pcb_138&quot;</span>,  <span class="st">&quot;pcb_153&quot;</span>, <span class="st">&quot;pcb_180&quot;</span>, <span class="st">&quot;pcb_192&quot;</span>),</a>
<a class="sourceLine" id="cb3-2" title="2">                   <span class="kw">c</span>(<span class="st">&quot;as&quot;</span>, <span class="st">&quot;cu&quot;</span>, <span class="st">&quot;pb&quot;</span>, <span class="st">&quot;sn&quot;</span>), </a>
<a class="sourceLine" id="cb3-3" title="3">                   <span class="kw">c</span>(<span class="st">&quot;carbaryl&quot;</span>, <span class="st">&quot;propoxur&quot;</span>, <span class="st">&quot;methoxychlor&quot;</span>, <span class="st">&quot;diazinon&quot;</span>, <span class="st">&quot;chlorpyrifos&quot;</span>))</a>
<a class="sourceLine" id="cb3-4" title="4">X &lt;-<span class="st"> </span><span class="kw">make.X</span>(simdata, <span class="dt">num.groups =</span> <span class="dv">3</span>, <span class="dt">groups =</span> group_list)</a>
<a class="sourceLine" id="cb3-5" title="5"><span class="kw">head</span>(X)</a>
<a class="sourceLine" id="cb3-6" title="6"><span class="co">#&gt;       pcb_118  pcb_138  pcb_153   pcb_180   pcb_192        as        cu</span></a>
<a class="sourceLine" id="cb3-7" title="7"><span class="co">#&gt; [1,] 2.360824 2.700214 3.536807 1.3630520  3.568884  4.332258 3.4998226</span></a>
<a class="sourceLine" id="cb3-8" title="8"><span class="co">#&gt; [2,] 2.788382 1.353622 2.328022 3.3261689 -2.020155 -1.146443 0.8174605</span></a>
<a class="sourceLine" id="cb3-9" title="9"><span class="co">#&gt; [3,] 6.246413 3.166612 6.851131 7.2149506 10.504976  5.042383 6.2631718</span></a>
<a class="sourceLine" id="cb3-10" title="10"><span class="co">#&gt; [4,] 3.642265 2.881070 3.760282 4.3231974  3.368709  2.814906 3.9192663</span></a>
<a class="sourceLine" id="cb3-11" title="11"><span class="co">#&gt; [5,] 3.481870 3.820329 3.178467 0.9451579  3.786788  6.331203 2.2228106</span></a>
<a class="sourceLine" id="cb3-12" title="12"><span class="co">#&gt; [6,] 4.088892 4.799032 5.467218 4.2547060  6.078460  2.622098 1.8577607</span></a>
<a class="sourceLine" id="cb3-13" title="13"><span class="co">#&gt;              pb       sn   carbaryl propoxur methoxychlor   diazinon</span></a>
<a class="sourceLine" id="cb3-14" title="14"><span class="co">#&gt; [1,]  7.6088824 3.975121  4.7416076 4.203351     4.598234  5.5571762</span></a>
<a class="sourceLine" id="cb3-15" title="15"><span class="co">#&gt; [2,] -1.6830696 1.710898 -0.4558587 2.255870     2.751266  2.6322118</span></a>
<a class="sourceLine" id="cb3-16" title="16"><span class="co">#&gt; [3,]  7.2252882 4.857086  7.2872371 5.274585     6.739046 12.0197435</span></a>
<a class="sourceLine" id="cb3-17" title="17"><span class="co">#&gt; [4,]  2.1143266 3.798077  0.7455287 3.111616     2.940376  0.6781079</span></a>
<a class="sourceLine" id="cb3-18" title="18"><span class="co">#&gt; [5,]  4.8262313 4.409647  0.6547444 2.309184     3.652926  0.6819997</span></a>
<a class="sourceLine" id="cb3-19" title="19"><span class="co">#&gt; [6,]  0.6898549 4.374542  4.3322814 4.672852     4.023438  6.7486293</span></a>
<a class="sourceLine" id="cb3-20" title="20"><span class="co">#&gt;      chlorpyrifos</span></a>
<a class="sourceLine" id="cb3-21" title="21"><span class="co">#&gt; [1,]    5.4269398</span></a>
<a class="sourceLine" id="cb3-22" title="22"><span class="co">#&gt; [2,]   -0.6704027</span></a>
<a class="sourceLine" id="cb3-23" title="23"><span class="co">#&gt; [3,]    8.1984625</span></a>
<a class="sourceLine" id="cb3-24" title="24"><span class="co">#&gt; [4,]    1.5744175</span></a>
<a class="sourceLine" id="cb3-25" title="25"><span class="co">#&gt; [5,]    1.7293713</span></a>
<a class="sourceLine" id="cb3-26" title="26"><span class="co">#&gt; [6,]    5.9936270</span></a></code></pre></div>
<p>We should note that the data in <code>X</code> must be chemical concentrations, which will be converted to quantiles during analysis.</p>
<ol start="2" style="list-style-type: decimal">
<li><code>make.x.s</code></li>
</ol>
<p><code>make.x.s</code> creates a vector which tells <code>gwqs.fit</code> the size and order of our groups. Conveniently, it uses the same arguments as <code>make.X</code>.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" title="1">x.s &lt;-<span class="st"> </span><span class="kw">make.x.s</span>(simdata, <span class="dt">num.groups =</span> <span class="dv">3</span>, <span class="dt">groups =</span> group_list)</a>
<a class="sourceLine" id="cb4-2" title="2">x.s</a>
<a class="sourceLine" id="cb4-3" title="3"><span class="co">#&gt; [1] 5 4 5</span></a></code></pre></div>
<p>With these steps all chemical concentration data have been prepared for analysis. To complete data preparation we define our outcome object</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" title="1">Y &lt;-<span class="st"> </span>simdata<span class="op">$</span>Y</a></code></pre></div>
<p>and split our data into training and validation sets. The training data will be used to estimate the weights in the indices and the validation data will be used to estimate the exposure effects and perform significance testing.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" title="1">Y.train &lt;-<span class="st"> </span>Y[<span class="dv">1</span><span class="op">:</span><span class="dv">700</span>]</a>
<a class="sourceLine" id="cb6-2" title="2">Y.valid &lt;-<span class="st"> </span>Y[<span class="dv">701</span><span class="op">:</span><span class="dv">1000</span>]</a>
<a class="sourceLine" id="cb6-3" title="3">X.train &lt;-<span class="st"> </span>X[<span class="dv">1</span><span class="op">:</span><span class="dv">700</span>,]</a>
<a class="sourceLine" id="cb6-4" title="4">X.valid &lt;-<span class="st"> </span>X[<span class="dv">701</span><span class="op">:</span><span class="dv">1000</span>,]</a></code></pre></div>
</div>
<div id="model-fitting" class="section level3">
<h3>Model Fitting</h3>
<p>To fit a model we will use the <code>gwqs.fit</code> function. First we pass the objects defined above (<strong>note</strong>: If arguments are not supplied for <code>y.train</code> and <code>x.train</code> the <code>y</code> and <code>x</code> data passed will be used for both training and validation). In addition to the <code>x</code> and <code>y</code> parameters there are <code>z</code> and <code>z.train</code> parameters for covariates, but as we are not including covariates in this model these paramters will be left empty. The <code>B</code> parameter tells the function how many bootstrap samples to use in estimation and <code>n.quantiles</code> specifies the number of quantiles to use. The <code>func</code> parameter tells the function which outcome type to fit the model for (continuous and binary outcomes are currently supported). In the example below, five quantiles (quintiles) are used for the chemicals.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" title="1">results &lt;-<span class="st"> </span><span class="kw">gwqs.fit</span>(<span class="dt">y =</span> Y.valid, <span class="dt">y.train =</span> Y.train, <span class="dt">x =</span> X.valid, <span class="dt">x.train =</span> X.train, <span class="dt">x.s =</span> x.s, </a>
<a class="sourceLine" id="cb7-2" title="2">                   <span class="dt">B=</span><span class="dv">100</span>, <span class="dt">n.quantiles =</span> <span class="dv">5</span>, <span class="dt">func =</span> <span class="st">&quot;binary&quot;</span>)</a></code></pre></div>
<p>If there are convergence problems after model fitting the <code>tol</code> and <code>delta</code> parameters can be adjusted. A larger <code>tol</code> value will relax the criteria for convergence and a larger <code>delta</code> will increase the step size for the bootstrap procedure; both will speed up convergence.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" title="1"><span class="kw">summary</span>(results<span class="op">$</span>fit)<span class="op">$</span>coefficients</a>
<a class="sourceLine" id="cb8-2" title="2"><span class="co">#&gt;                Estimate Std. Error    z value     Pr(&gt;|z|)</span></a>
<a class="sourceLine" id="cb8-3" title="3"><span class="co">#&gt; (Intercept) -0.36296995 0.27747793 -1.3081039 0.1908380843</span></a>
<a class="sourceLine" id="cb8-4" title="4"><span class="co">#&gt; GWQS1       -0.12558969 0.10612361 -1.1834284 0.2366394011</span></a>
<a class="sourceLine" id="cb8-5" title="5"><span class="co">#&gt; GWQS2        0.02733979 0.11027004  0.2479349 0.8041847797</span></a>
<a class="sourceLine" id="cb8-6" title="6"><span class="co">#&gt; GWQS3        0.35752680 0.09285251  3.8504807 0.0001178862</span></a></code></pre></div>
<p>The results above are the regression coefficients for the estimated exposure indices. This is in the validation set.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" title="1"><span class="kw">summary</span>(results<span class="op">$</span>fit)<span class="op">$</span>aic</a>
<a class="sourceLine" id="cb9-2" title="2"><span class="co">#&gt; [1] 405.7135</span></a></code></pre></div>
<p>Next is the AIC for the model we have fit.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" title="1"><span class="kw">exp</span>(<span class="kw">confint</span>(results<span class="op">$</span>fit))</a>
<a class="sourceLine" id="cb10-2" title="2"><span class="co">#&gt; Waiting for profiling to be done...</span></a>
<a class="sourceLine" id="cb10-3" title="3"><span class="co">#&gt;                 2.5 %   97.5 %</span></a>
<a class="sourceLine" id="cb10-4" title="4"><span class="co">#&gt; (Intercept) 0.4016993 1.195476</span></a>
<a class="sourceLine" id="cb10-5" title="5"><span class="co">#&gt; GWQS1       0.7149657 1.084859</span></a>
<a class="sourceLine" id="cb10-6" title="6"><span class="co">#&gt; GWQS2       0.8276495 1.276471</span></a>
<a class="sourceLine" id="cb10-7" title="7"><span class="co">#&gt; GWQS3       1.1949162 1.720857</span></a></code></pre></div>
<p>And finally are the 95% CIs for the odds ratios of the indicies. We can see from the results that of our three groups only the third, GWQS3, is statistically significant at the 0.05 level, and has a 95% CI of (1.2, 1.7) for its odds ratio.</p>
</div>
<div id="examining-individual-component-weights" class="section level3">
<h3>Examining Individual Component Weights</h3>
<p>The weights for individiual chemical components in each group are listed in the object returned by <code>gwqs.fit</code>. To view them graphically in descending order of importance, we can use the <code>plot.weights</code> function. Besides the model fit object, we just need to create a string vector naming our groups. This vector’s order matters - names must match their corresponding index in the group list defined above.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" title="1">chem_groups &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;PCBs&quot;</span>, <span class="st">&quot;Metals&quot;</span>, <span class="st">&quot;Insecticides&quot;</span>)</a>
<a class="sourceLine" id="cb11-2" title="2"><span class="kw">weight.plot</span>(results, chem_groups)</a></code></pre></div>
<div class="figure">
<img src="data:image/png;base64,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" alt="Figure 1: Importance plot for chemical concentration weights of GWQS1 index" width="60%" height="60%" />
<p class="caption">
Figure 1: Importance plot for chemical concentration weights of GWQS1 index
</p>
</div>
<div class="figure">
<img src="data:image/png;base64,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" alt="Figure 2: Importance plot for chemical concentration weights of GWQS2 index" width="60%" height="60%" />
<p class="caption">
Figure 2: Importance plot for chemical concentration weights of GWQS2 index
</p>
</div>
<div class="figure">
<img src="data:image/png;base64,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" alt="Figure 3: Importance plot for chemical concentration weights of GWQS3 index" width="60%" height="60%" />
<p class="caption">
Figure 3: Importance plot for chemical concentration weights of GWQS3 index
</p>
</div>
<p>Our one significant index was a group of insecticide compounds. Of the five chemicals it appears methoxychlor was mostly responsible for the association GWQS3 had with the outcome variable.</p>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
